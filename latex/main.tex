\documentclass[12pt,a4paper]{report}

% ============================ LaTeX Packages ============================
\usepackage[a4paper,left=3.5cm,right=3cm,top=3cm,bottom=3cm]{geometry} % page margins
\usepackage[protrusion=true,nopatch=footnote]{microtype} % micro-typographic refinements
\usepackage{setspace}                         % line spacing
\usepackage{fancyhdr}                         % custom header/footer
\usepackage{newtxtext,newtxmath}              % Times New Roman font
% amsmath, amssymb, amsthm are already loaded by newtxmath
\usepackage{graphicx}                         % images
\usepackage{hyperref}                         % hyperlinks in TOC
\usepackage{booktabs}                         % professional tables
\usepackage{array}                            % table alignment
\usepackage{tabularx}                         % adaptive-width tables
\usepackage{multicol}                         % multi-column layout
\usepackage[toc,page]{appendix}               % appendix handling
\usepackage[nottoc]{tocbibind}                % include References in TOC
\usepackage{caption}                          % caption formatting
\usepackage{xcolor}                           % colour support
\usepackage{titlesec}                         % heading font control
\usepackage{eso-pic}                          % watermark
\usepackage{tikz}                             % precise watermark positioning
\usepackage{datetime}                         % date formatting
\usepackage{tocloft}                          % TOC formatting
% titlesec already loaded above
\usepackage{titletoc}                         % enhanced TOC formatting
\usepackage{cite}                             % bibtex citation
% \usepackage{lipsum}                         % filler text (unused)
% \usepackage{showframe}
\usepackage{etoolbox}
\usepackage{ragged2e}
\newcolumntype{L}[1]{>{\RaggedRight\arraybackslash}p{#1}}

% ================================= Equations ================================
\AtBeginEnvironment{equation}{\setstretch{1}}             % single spacing for equations
\AtEndEnvironment{equation}{}                             % restore after equation
\numberwithin{equation}{section}                          % equation numbering follows section
\renewcommand{\theequation}{\arabic{section}.\arabic{equation}}% display as 1.1

% ================================= Footer ================================
\pagestyle{fancy}                                         % enable fancyhdr
\fancyhf{}                                                % clear defaults
\fancyfoot[R]{\fontsize{12pt}{14pt}\selectfont \thepage}  % right footer page number 12pt
\renewcommand{\headrulewidth}{0pt}                        % no header rule
\renewcommand{\footrulewidth}{0pt}                        % no footer rule
\fancypagestyle{plain}{                                   % plain page style
    \fancyhf{} 
    \fancyfoot[R]{\fontsize{12pt}{14pt}\selectfont \thepage}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
}

% ================================= TOC ================================
% TOC title format (centered + 18pt + bold + underline)
\renewcommand{\contentsname}{}
\newcommand{\customtoc}{
    \clearpage
    \begin{center}
        \underline{\textbf{\fontsize{18pt}{18pt}\selectfont Table of Contents}}
    \end{center}
    \vspace{-1.2\baselineskip}
}
% Custom "Pages" column header, right-aligned
\renewcommand{\cftaftertoctitle}{%
    \vspace{-1.5\baselineskip} % reduce space after Table of Contents
    \hfill\underline{Pages} % right-aligned
    \par\vskip-2\baselineskip % adjust spacing
}
% TOC formatting
% Chapter level
\renewcommand{\cftchapfont}{\bfseries}                  % bold chapter titles
\renewcommand\thechapter{\arabic{chapter}}       % chapter number only
\renewcommand\thesection{\arabic{chapter}.\arabic{section}} % fix section numbering
\renewcommand{\cftchappresnum}{Chapter\enspace}   % "Chapter " prefix in TOC
\renewcommand{\cftchapaftersnumb}{}                     % nothing after chapter number
\setlength{\cftchapnumwidth}{7.3em}                       % chapter number width
% Section level
\renewcommand{\cftsecfont}{}                            % section font
\renewcommand{\cftsecpresnum}{}                         % section number prefix
\renewcommand{\cftsecaftersnumb}{}                      % section number suffix
\setlength{\cftsecindent}{0em}                          % section indent
\setlength{\cftsecnumwidth}{2em}                        % section number width
\renewcommand{\cftsecdotsep}{\cftnodots}                % remove dot leaders
\renewcommand{\cftsecpagefont}{\color{white}}        % hide page numbers
% Spacing
\setlength{\cftbeforechapskip}{0.5em}                   % space before chapter
\setlength{\cftbeforesecskip}{0.5em}                    % space before section

% ========================== Chapter formatting ==========================
% Numbered \chapter: "Chapter 1" on its own line, title left-aligned below
\titleformat{\chapter}[display]            % "Chapter 1" on separate line
  {\normalfont\Huge\bfseries}  % Huge, bold
  {Chapter\enspace\thechapter}             % shows "Chapter 1"
  {0em}                                    % space between number and title
  {\raggedright}                           % title left-aligned
% Unnumbered \chapter* (Abstract, Appendices, etc.)
\titleformat{name=\chapter,numberless}[display]
  {\normalfont\Huge\bfseries}  % Huge, bold
  {}                                       % no number
  {-2.5em}                                 % space between number and title
  {\centering}                             % title centered
% Chapter spacing
\titlespacing{\chapter}{0pt}{-2em}{0em}  % numbered chapters
\titlespacing{name=\chapter,numberless}{0pt}{0em}{\baselineskip}  % unnumbered chapters

% ========================== Section formatting ==========================
% Numbered \section
\titleformat{\section}                        % section formatting
  {\normalfont\fontsize{16pt}{16pt}\bfseries} % 16pt bold
  {\thesection\enspace}                       % section number
  {0pt}                                       % before-title space
  {\raggedright}                              % left-aligned
% Unnumbered \section*
\titleformat{name=\section,numberless}[display]
  {\clearpage\normalfont\fontsize{16pt}{16pt}\bfseries}
  {}
  {-1em}
  {\centering}
\titlespacing{\section}{0pt}{0.5\baselineskip}{0.5\baselineskip}
\titlespacing{name=\section,numberless}{0pt}{0em}{1.5\baselineskip}

\global\sloppy  % allow loose line breaking
\hbadness=10000 % suppress underfull hbox warnings
\vbadness=10000 % suppress underfull vbox warnings
\hfuzz=2pt      % ignore tiny overfull boxes

% ======================= Subsection formatting ========================
% Numbered \subsection
\titleformat{\subsection}    
  {\normalfont\fontsize{14pt}{14pt}\bfseries}  % 14pt bold
  {\thesubsection\enspace}                     % subsection number
  {0pt}                                        % before-title space
  {\raggedright}                               % left-aligned

% Subsection spacing
\titlespacing{\subsection}{0pt}{0.5\baselineskip}{0.5\baselineskip}


\begin{document}

\onehalfspacing % 1.5x line spacing

% ================================ Custom colours ================================
\definecolor{DeepGreen}{rgb}{0.0, 0.690, 0.314}

% ================================ Custom settings ================================
% No paragraph indent
\setlength{\parindent}{0pt}
% Custom date format
\newdateformat{mydate}{\THEDAY\ \monthname[\THEMONTH]\ \THEYEAR}
% Unified figure/table numbering and caption style
\renewcommand{\thefigure}{\arabic{chapter}.\arabic{figure}}
\setlength{\cftfignumwidth}{4.5em}
\renewcommand{\figurename}{Figure}
\renewcommand{\thetable}{\arabic{chapter}.\arabic{table}}
\setlength{\cfttabnumwidth}{4.5em}
\renewcommand{\tablename}{Table}
\captionsetup{
    font=small,
    labelfont=bf,
    labelsep=period,
    justification=centering,
    singlelinecheck=false
}
\captionsetup[figure]{name=Figure}
\captionsetup[table]{name=Table}
% List of Figures formatting
\makeatletter
\renewcommand{\listoffigures}{%
    \begingroup
    \vspace{-2em} % reduce top spacing
    \chapter*{\listfigurename}%
    \@starttoc{lof}%
    \endgroup
}
\makeatother
% List of Tables formatting
\makeatletter
\renewcommand{\listoftables}{%
    \begingroup
    \vspace{-2em} % reduce top spacing
    \chapter*{\listtablename}%
    \@starttoc{lot}%
    \endgroup
}
\makeatother


% ======================== Front Matter =======================
\hypersetup{pageanchor=false}                  % avoid duplicate page anchors while page numbers are suppressed
\pagenumbering{gobble}
\input{c-front-matter/title-page}             % title page
\input{c-front-matter/originality}            % originality statement
\input{c-front-matter/supervisor-declaration} % supervisor declaration
\input{c-front-matter/authorship}             % authorship statement

\clearpage
\centering\customtoc
% \addtocontents{toc}{\protect\setcounter{tocdepth}{-1}} % hide TOC (causes empty TOC)
\tableofcontents % generate TOC
% \addtocontents{toc}{\protect\setcounter{tocdepth}{1}}  % restore TOC
\clearpage

\clearpage
\pagenumbering{roman}                         % roman numerals for front matter
\hypersetup{pageanchor=true}
\setcounter{page}{1}                          % start from i
\pagestyle{fancy}                             % keep page numbers in right footer
\input{c-front-matter/abstract}               % abstract
\input{c-front-matter/acknowledgement}        % acknowledgement (optional)
\input{c-front-matter/acronyms}               % acronyms (optional)
\input{c-front-matter/symbols}                % symbols (optional)
\listoffigures                                % list of figures
\listoftables                                 % list of tables

% ========================= Main Content ========================
\clearpage
\pagenumbering{arabic}       % arabic numerals for main content
\setcounter{page}{1}         % start from 1
\pagestyle{fancy}            % keep page numbers in right footer
\input{chapter-1/chapter-1}  % Chapter 1
\input{chapter-2/chapter-2}  % Chapter 2
\input{chapter-3/chapter-3}  % Chapter 3
\input{chapter-4/chapter-4}  % Chapter 4
\input{chapter-5/chapter-5}  % Chapter 5
\input{chapter-6/chapter-6}  % Chapter 6

% ============================ References ===========================
% bib-based References management
\renewcommand{\bibname}{References}
\bibliographystyle{IEEEtran}             % IEEE citation style
\bibliography{c-back-matter/references}  % .bib file (without .bib extension)

% ============================== Appendix ==============================
\appendix
\input{c-back-matter/appendix-a} % Appendix A
\input{c-back-matter/appendix-b} % Appendix B

\end{document}
